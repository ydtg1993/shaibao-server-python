(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-380750ca"],{"386b":function(e,t,a){var r=a("5ca1"),n=a("79e5"),i=a("be13"),o=/"/g,l=function(e,t,a,r){var n=String(i(e)),l="<"+t;return""!==a&&(l+=" "+a+'="'+String(r).replace(o,"&quot;")+'"'),l+">"+n+"</"+t+">"};e.exports=function(e,t){var a={};a[e]=t(l),r(r.P+r.F*n(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",a)}},"660f":function(e,t,a){"use strict";var r=a("a149"),n=a.n(r);n.a},a149:function(e,t,a){},c116:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("充值配置")]),e._v(" "),a("el-switch",{staticStyle:{float:"right"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.openSet(e.is_open)}},model:{value:e.is_open,callback:function(t){e.is_open=t},expression:"is_open"}})],1),e._v(" "),a("div",{attrs:{"element-loading-spinner":"el-icon-close"}},[a("div",{staticStyle:{overflow:"auto",height:"500px"},attrs:{"element-loading-spinner":"el-icon-close"}},[a("el-form",{ref:"rechargeSetRules",attrs:{model:e.rechargeSetForm,rules:e.rechargeSetRules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"赠送方式",prop:"method"}},[e.edit?a("el-select",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择赠送方式"},on:{change:e.methodChange},model:{value:e.rechargeSetForm.method,callback:function(t){e.$set(e.rechargeSetForm,"method",t)},expression:"rechargeSetForm.method"}},e._l(e.methodOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):a("span",{staticClass:"bg-backdrop"},[e._v(e._s(e.getMethodTitle(e.rechargeSetForm.method)))])],1),e._v(" "),a("el-form-item",{attrs:{label:"赠品类型",prop:"type"}},[e.edit?a("el-select",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择赠品类型"},model:{value:e.rechargeSetForm.type,callback:function(t){e.$set(e.rechargeSetForm,"type",t)},expression:"rechargeSetForm.type"}},e._l(e.typeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):a("span",{staticClass:"bg-backdrop"},[e._v(e._s(e.getTypeTitle(e.rechargeSetForm.type)))])],1),e._v(" "),a("el-form-item",{attrs:{label:"持续时间",prop:"range"}},[e.edit?a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],"value-format":"yyyyMMddHHmmss"},model:{value:e.rechargeSetForm.range,callback:function(t){e.$set(e.rechargeSetForm,"range",t)},expression:"rechargeSetForm.range"}})],1):a("span",{staticClass:"bg-backdrop"},[e._v(e._s(e.stringToTimeString(e.rechargeSetForm.range[0])+" - "+e.stringToTimeString(e.rechargeSetForm.range[1])))])]),e._v(" "),"PERCENTAGE"===e.rechargeSetForm.method?a("el-form-item",{attrs:{label:"百分比赠送",prop:"value"}},[e.edit?a("el-input",{directives:[{name:"only-number",rawName:"v-only-number",value:{max:100,min:0,precision:2},expression:"{max:100,min:0,precision:2}"}],staticStyle:{width:"400px"},attrs:{placeholder:"请输入赠送百分比"},model:{value:e.rechargeSetForm.value,callback:function(t){e.$set(e.rechargeSetForm,"value",t)},expression:"rechargeSetForm.value"}},[a("template",{slot:"append"},[e._v("%")])],2):a("span",[e._v(e._s(e.rechargeSetForm.value))])],1):e._e(),e._v(" "),"INTERVAL"===e.rechargeSetForm.method?a("el-form-item",{attrs:{label:"区间赠送",prop:"value"}},[a("interval",{ref:"interval",attrs:{"label-name":"","show-data":e.interval_data,"is-edit":e.interval_edit}})],1):e._e(),e._v(" "),"FIXED"===e.rechargeSetForm.method?a("el-form-item",{attrs:{label:"固定赠送",prop:"value"}},[a("fixed",{ref:"fixed",attrs:{"label-name":"","show-data":e.fixed_data,"is-edit":e.fixed_edit}})],1):e._e()],1)],1),e._v(" "),a("div",{staticStyle:{padding:"14px"},attrs:{align:"right"}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.loading?a("el-button",{attrs:{type:"primary"},on:{click:e.editForm}},[e._v("编辑")]):e._e(),e._v(" "),e.loading?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.cancelForm}},[e._v("取消")]),e._v(" "),e.loading?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.saveForm}},[e._v("保存")])],1)])])])],1)},n=[],i=(a("ac6a"),a("d263"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"MIN",align:"center",prop:"annex_type"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?a("el-input",{attrs:{placeholder:"请输入区间下限"},model:{value:t.row.min,callback:function(a){e.$set(t.row,"min",a)},expression:"scope.row.min"}}):a("span",[e._v(e._s(t.row.min))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"充值金额",align:"center",prop:"annex_type"}},[e._v("\n      "+e._s("<= 充值金额 <")+"\n    ")]),e._v(" "),a("el-table-column",{attrs:{label:"MAX",align:"center",prop:"annex_value"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?a("el-input",{attrs:{placeholder:"请输入区间上限"},model:{value:t.row.max,callback:function(a){e.$set(t.row,"max",a)},expression:"scope.row.max"}}):a("span",[e._v(e._s(t.row.max))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"奖励值",align:"center",prop:"annex_value"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?a("el-input",{attrs:{placeholder:"请输入奖励值"},model:{value:t.row.reward,callback:function(a){e.$set(t.row,"reward",a)},expression:"scope.row.reward"}}):a("span",[e._v(e._s(t.row.reward))])]}}])}),e._v(" "),e.isEdit?a("el-table-column",{attrs:{width:"100px",label:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(a){return e.addRow(t.row)}}}),e._v(" "),e.tableData.length>1?a("el-button",{attrs:{type:"text",icon:"el-icon-minus"},on:{click:function(a){return e.delRow(t.row)}}}):e._e()]}}],null,!1,3098127174)}):e._e()],1)],1)}),o=[],l={name:"Annex",props:{labelName:{required:!0,type:String},showData:{required:!0,type:Array},isEdit:{required:!0,type:Boolean}},data:function(){return{tableData:[]}},created:function(){this.setDetail(this.showData)},methods:{setDetail:function(e){if(e.length>0)for(var t=0;t<e.length;t++)this.tableData.push({index:e[t].index,min:e[t].min,max:e[t].max,reward:e[t].reward});else this.tableData.push({index:0,min:null,max:null,reward:null})},addRow:function(e){this.tableData.push({index:this.tableData.length,min:null,max:null,reward:null}),console.log(this.tableData)},delRow:function(e){var t=this;console.log(e.serial),void 0!==e.serial&&null!==e.serial?this.$confirm("已经添加的了数据，确定要删除?","提示").then(function(){t.tableData.splice(e.index,1),t.$emit("changeDetail",t.tableData)}).catch(function(){}):this.tableData.splice(e.index,1);for(var a=0;a<this.tableData.length;a++)this.tableData[a].index=a}}},s=l,c=a("2877"),u=Object(c["a"])(s,i,o,!1,null,"2dbc5b0b",null),d=u.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"充值金额",align:"center",prop:"recharge_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?a("el-input",{attrs:{placeholder:"请输入充值金额"},model:{value:t.row.recharge_amount,callback:function(a){e.$set(t.row,"recharge_amount",a)},expression:"scope.row.recharge_amount"}}):a("span",[e._v(e._s(t.row.recharge_amount))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"奖励金额",align:"center",prop:"reward_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEdit?a("el-input",{attrs:{placeholder:"请输入奖励金额"},model:{value:t.row.reward_amount,callback:function(a){e.$set(t.row,"reward_amount",a)},expression:"scope.row.reward_amount"}}):a("span",[e._v(e._s(t.row.recharge_amount))])]}}])}),e._v(" "),e.isEdit?a("el-table-column",{attrs:{width:"100px",label:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(a){return e.addRow(t.row)}}}),e._v(" "),e.tableData.length>1?a("el-button",{attrs:{type:"text",icon:"el-icon-minus"},on:{click:function(a){return e.delRow(t.row)}}}):e._e()]}}],null,!1,3098127174)}):e._e()],1)],1)},p=[],m={name:"Annex",props:{labelName:{required:!0,type:String},showData:{required:!0,type:Array},isEdit:{required:!0,type:Boolean}},data:function(){return{tableData:[]}},created:function(){this.setDetail(this.showData)},methods:{setDetail:function(e){if(e.length>0)for(var t=0;t<e.length;t++)this.tableData.push({index:e[t].index,recharge_amount:e[t].recharge_amount,reward_amount:e[t].reward_amount});else this.tableData.push({index:0,recharge_amount:null,reward_amount:null})},addRow:function(e){this.tableData.push({index:this.tableData.length,recharge_amount:null,reward_amount:null}),console.log(this.tableData)},delRow:function(e){var t=this;console.log(e.serial),void 0!==e.serial&&null!==e.serial?this.$confirm("已经添加的了数据，确定要删除?","提示").then(function(){t.tableData.splice(e.index,1),t.$emit("changeDetail",t.tableData)}).catch(function(){}):this.tableData.splice(e.index,1);for(var a=0;a<this.tableData.length;a++)this.tableData[a].index=a}}},g=m,f=Object(c["a"])(g,h,p,!1,null,"8307959a",null),v=f.exports,_=a("b775");function b(e){return Object(_["a"])({url:"api/setting/recharge/methods",method:"get",loading:!1,data:e})}function S(e){return Object(_["a"])({url:"api/setting/recharge/types",method:"get",loading:!1,data:e})}function w(e){return Object(_["a"])({url:"api/setting/recharge/save",method:"post",loading:!0,data:e})}function x(e){return Object(_["a"])({url:"api/setting/recharge/info",method:"get",loading:!1,data:e})}function y(e){return Object(_["a"])({url:"api/setting/recharge/switch",method:"get",loading:!1,data:e})}var F={name:"RechargeSet",components:{Interval:d,Fixed:v},data:function(){return{loading:!0,edit:!1,methodOptions:[],typeOptions:[],is_open:null,rechargeSetForm:{method:null,type:null,range:["",""],value:0},interval_data:[],fixed_data:[],percentage_data:null,fixed_edit:!1,interval_edit:!1,rechargeSetRules:{method:[{required:!0,message:"请选择赠送方式",trigger:"blur"}],type:[{required:!0,message:"请选择赠品类型",trigger:"blur"}],range:[{required:!0,message:"请设置时间区间",trigger:"blur"}],value:[{required:!0,message:"请设置充值策略",trigger:"blur"}]}}},created:function(){this.reqSearchMethods(),this.reqSearchTypes(),this.reqObjInfo()},methods:{methodChange:function(e){"INTERVAL"===this.rechargeSetForm.method?this.rechargeSetForm.value=this.interval_data:"FIXED"===this.rechargeSetForm.method?this.rechargeSetForm.value=this.fixed_data:"PERCENTAGE"===this.rechargeSetForm.method&&(this.rechargeSetForm.value=this.percentage_data)},reqObjInfo:function(){var e=this;x().then(function(t){e.is_open=t.data.activate,"{}"!==JSON.stringify(t.data.info)&&(e.rechargeSetForm=t.data.info),"INTERVAL"===e.rechargeSetForm.method?e.interval_data=e.rechargeSetForm.value:"FIXED"===e.rechargeSetForm.method?e.fixed_data=e.rechargeSetForm.value:"PERCENTAGE"===e.rechargeSetForm.method&&(e.percentage_data=e.rechargeSetForm.value)}).catch(function(e){})},editForm:function(){this.loading=!1,this.edit=!0,this.fixed_edit=!0,this.interval_edit=!0},saveForm:function(){var e=this;"INTERVAL"===this.rechargeSetForm.method?this.rechargeSetForm.value=this.$refs.interval.tableData:"FIXED"===this.rechargeSetForm.method&&(this.rechargeSetForm.value=this.$refs.fixed.tableData),console.log(this.rechargeSetForm),this.$refs.rechargeSetRules.validate(function(t){t&&w(e.rechargeSetForm).then(function(t){e.loading=!0,e.edit=!1,e.fixed_edit=!1,e.interval_edit=!1}).catch(function(e){})})},cancelForm:function(){this.loading=!0,this.edit=!1,this.fixed_edit=!1,this.interval_edit=!1},handleChange:function(e){console.log(e)},openSet:function(e){var t=this;console.log(e),this.is_open=!this.is_open;var a=this.is_open?"确认关闭大厅吗？":"确认开启大厅吗？",r=this.is_open?"关闭策略成功":"开启策略成功";this.$confirm(a).then(function(e){y().then(function(e){t.is_open=!t.is_open,t.$message({showClose:!0,message:r,type:"success"})}).catch(function(e){})}).catch(function(e){})},reqSearchMethods:function(){var e=this;b().then(function(t){e.methodOptions=t.data}).catch(function(e){})},reqSearchTypes:function(){var e=this;S().then(function(t){e.typeOptions=t.data}).catch(function(e){})},stringToTimeString:function(e){return""===e?"":e.slice(0,4)+"-"+e.slice(4,6)+"-"+e.slice(6,8)+" "+e.slice(8,10)+":"+e.slice(10,12)+":"+e.slice(12,14)},getTypeTitle:function(e){var t="";return this.typeOptions.forEach(function(a){a.value===e&&(t=a.label)}),t},getMethodTitle:function(e){var t="";return this.methodOptions.forEach(function(a){a.value===e&&(t=a.label)}),t}}},D=F,k=(a("660f"),Object(c["a"])(D,r,n,!1,null,"50a826cb",null));t["default"]=k.exports},d263:function(e,t,a){"use strict";a("386b")("fixed",function(e){return function(){return e(this,"tt","","")}})}}]);